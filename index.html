<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>我的日常記錄</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      background: #f8f0fb;
      margin: 0;
      padding: 0;
    }
    header {
      background: #d8a7f0;
      color: white;
      text-align: center;
      padding: 1rem;
      font-size: 1.5rem;
      font-weight: bold;
    }
    nav {
      display: flex;
      background: #f3d9fa;
    }
    nav button {
      flex: 1;
      padding: 1rem;
      border: none;
      background: #f3d9fa;
      font-size: 1rem;
      cursor: pointer;
    }
    nav button.active {
      background: #d8a7f0;
      color: white;
    }
    .tab {
      display: none;
      padding: 1rem;
    }
    .tab.active {
      display: block;
    }
    form {
      background: white;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      max-width: 400px;
      margin: auto;
    }
    label {
      display: block;
      margin-top: 0.5rem;
    }
    input, select, button {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.2rem;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    button[type="submit"] {
      background: #d8a7f0;
      color: white;
      border: none;
      margin-top: 1rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>我的日常記錄</header>
  
  <nav>
    <button class="active" onclick="showTab('expense')">支出</button>
    <button onclick="showTab('weight')">體重</button>
    <button onclick="showTab('bp')">血壓</button>
  </nav>

  <!-- 支出 -->
  <div id="expense" class="tab active">
    <form onsubmit="saveExpense(event)">
      <label>日期：
        <input type="date" id="expDate" required>
      </label>
      <label>分類：
        <select id="expCategory">
          <option>食</option>
          <option>衣</option>
          <option>住</option>
          <option>行</option>
          <option>其他</option>
        </select>
      </label>
      <label>金額：
        <input type="number" id="expAmount" required>
      </label>
      <label>備註：
        <input type="text" id="expNote">
      </label>
      <button type="submit">送出</button>
    </form>
  </div>

  <!-- 體重 -->
  <div id="weight" class="tab">
    <form onsubmit="saveWeight(event)">
      <label>時間：
        <input type="datetime-local" id="weightTime" required>
      </label>
      <label>體重 (kg)：
        <input type="number" step="0.1" id="weightValue" required>
      </label>
      <button type="submit">送出</button>
    </form>
  </div>

  <!-- 血壓 -->
  <div id="bp" class="tab">
    <form onsubmit="saveBP(event)">
      <label>時間：
        <input type="datetime-local" id="bpTime" required>
      </label>
      <label>收縮壓：
        <input type="number" id="bpSys" required>
      </label>
      <label>舒張壓：
        <input type="number" id="bpDia" required>
      </label>
      <label>脈搏：
        <input type="number" id="bpPulse">
      </label>
      <button type="submit">送出</button>
    </form>
  </div>

  <script>
    // TODO: 把這裡換成你自己的 Google Apps Script Web App URL
    const API_URL = "https://script.google.com/macros/s/AKfycbyDIgFN-GqqBPUYIiubOntPBFFK9hGGC5Gm3Oe6s79Z513Rr5fqBjIzwxN8Ip6o-wbQog/exec";

    function showTab(tabId) {
      document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
      document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));
      document.getElementById(tabId).classList.add("active");
      document.querySelector(`nav button[onclick="showTab('${tabId}')"]`).classList.add("active");
    }

    function saveExpense(e) {
      e.preventDefault();
      fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({
          apiKey: "qazxswedc",
	  type: "expense",
          date: document.getElementById("expDate").value,
          category: document.getElementById("expCategory").value,
          amount: document.getElementById("expAmount").value,
          note: document.getElementById("expNote").value
        }),
        headers: { "Content-Type": "application/json" }
      })
      .then(res => res.json())
      .then(() => alert("✅ 支出已記錄！"))
      .catch(err => alert("❌ 發生錯誤：" + err));
    }

    function saveWeight(e) {
      e.preventDefault();
      fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({
          apiKey: "qazxswedc",
          type: "weight",
          datetime: document.getElementById("weightTime").value,
          weight: document.getElementById("weightValue").value
        }),
        headers: { "Content-Type": "application/json" }
      })
      .then(res => res.json())
      .then(() => alert("✅ 體重已記錄！"))
      .catch(err => alert("❌ 發生錯誤：" + err));
    }

    function saveBP(e) {
      e.preventDefault();
      fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({
          apiKey: "qazxswedc",
          type: "bp",
          datetime: document.getElementById("bpTime").value,
          sys: document.getElementById("bpSys").value,
          dia: document.getElementById("bpDia").value,
          pulse: document.getElementById("bpPulse").value
        }),
        headers: { "Content-Type": "application/json" }
      })
      .then(res => res.json())
      .then(() => alert("✅ 血壓已記錄！"))
      .catch(err => alert("❌ 發生錯誤：" + err));
    }
  </script>
</body>
</html>
